<style type='text/css'>
    .embeddedServiceHelpButton {
        font-family: "HelveticaNeue", "Helvetica", "Arial", sans-serif;
    }


    .embeddedServiceSidebar.layout-docked .dockableContainer {
        border-radius: 4px 4px 0 0;
    }

    .embeddedServiceSidebarFeature button {
        background-color: #FF0A0A;
    }

    .sidebarHeader h2 {
        color: #444444;
        font-size: 20px;

    }

    .sidebarHeader button {
        height: 0;
        width: 0;
        padding: 0 0 0 8px;
    }

    .sidebarHeader button:focus,
    .sidebarHeader button:active {
        outline: none
    }

    .sidebarHeader svg {
        fill: white;
        width: 16px;
    }

    .embeddedServiceSidebarButton {
        font-family: inherit;
    }

    .embeddedServiceSidebarButton:focus {
        background-color: #FF0A0A !important;
    }


    .embeddedServiceSidebarMinimizedDefaultUI .embeddedServiceIcon,
    .embeddedServiceHelpButton .embeddedServiceIcon {
        display: none !important;
    }

    .embeddedServiceHelpButton .helpButton {
        top: 200px;
        right: -210px;
        width: 190px;
        height: 80px;
        transition: right 0.2s ease-out !important;
    }

    .embeddedServiceHelpButton .helpButton .uiButton {
        background-color: #FF0A0A;
        border-radius: 5px 0 0 5px !important;
        width: 100%;
        height: 100%;
        box-shadow: 0 16px 18px 0 rgba(0, 0, 0, 0.13), 0 4px 6px 0 rgba(0, 0, 0, 0.16);
    }

    .embeddedServiceHelpButton .helpButton .uiButton:hover {
        background-color: #FF0A0A;

    }

    .embeddedServiceHelpButton .helpButton .uiButton:hover::before,
    .embeddedServiceHelpButton .helpButton .uiButton:focus::before {
        border-radius: 4px;
    }

    .embeddedServiceHelpButton .helpButton .helpButtonEnabled:hover::before,
    .embeddedServiceHelpButton .helpButton .helpButtonEnabled:focus::before {
        background-color: rgb(0, 0, 0, 0);
    }

    .embeddedServiceHelpButton .helpButtonLabel {
        text-align: left;
        font-size: 18px;
        padding: 10px 18px;
        text-transform: none;
        font-weight: 500;
    }

    .minimizeButton:hover:before,
    .minimizeButton:hover,
    .minimizeButton:focus,
    .minimizeButton:active,
    .closeButton:hover:before,
    .closeButton:hover,
    .closeButton:focus,
    .closeButton:active {
        background-color: #FFFFFF !important;
    }



    .embeddedServiceSidebarForm span {
        text-transform: none;
    }

    .embeddedServiceSidebarForm .uiButton {
        background-color: #FF0A0A;
        border-radius: 4px;
    }

    .embeddedServiceSidebarForm .uiButton:hover {
        background-color: #FF0A0A;
    }

    .embeddedServiceHelpButton .uiButton .helpButtonLabel .message {
        white-space: normal;

    }


    .embeddedServiceSidebarMinimizedDefaultUI.helpButton {
        border-radius: 5px 0 0 5px !important;
        top: 200px;
        right: 0px;
        width: 190px;
        height: 80px;
        box-shadow: 0 16px 18px 0 rgba(0, 0, 0, 0.13), 0 4px 6px 0 rgba(0, 0, 0, 0.16);
        background-color: #FF0A0A;
    }


    .embeddedServiceSidebarMinimizedDefaultUI .message {
        white-space: normal !important;
        text-align: left;
        text-transform: none;
        font-size: 18px;
        font-weight: 500;
    }

    .embeddedServiceSidebarMinimizedDefaultUI.minimizedContainer:hover,
    .embeddedServiceSidebarMinimizedDefaultUI.minimizedContainer:focus {
        background-color: #FF0A0A;
        border-radius: 0;
    }

    .embeddedServiceSidebarFormField.offline-info {
        text-align: left;
        margin-top: 12px;
        font-size: smaller;
    }

    .sidebarBody .uiInput input {
        border-radius: 0 !important;
    }

    .dialogState .dialogIcon circle {
        fill: gray !important;
    }

    .dialogButtonContainer .dialogButton {
        text-transform: none;
    }


    @media (max-width: 640px) {
        .EmbeddedServiceHelpButton {
            max-width: 130px !important;
            bottom: 200px !important;
        }

        .EmbeddedServiceHelpButton .helpButtonLabel {
            font-size: 12px;
        }

        .EmbeddedServiceHelpButton .flatButton {
            min-width: 130px !important;
        }
    }
</style>
<script>
    let inInit = false;
    const changeEvent = new Event('change');
    window.addEventListener('DOMContentLoaded', fetchElements);
    function fetchElements() {
        let headerElement = document.querySelector(".block-chat_header");
        if (headerElement) {
            let observer = new IntersectionObserver((entries, observer) => {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        let chatbutton = document.querySelector('.helpButton');
                        if (chatbutton) {

                            chatbutton.style.right = '-210px '
                        }
                        else
                            initAgain()
                    }
                    else {
                        let chatbutton1 = document.querySelector('.helpButton');
                        if (chatbutton1) {

                            chatbutton1.style.right = '0px'
                        }
                        else {
                            initAgain()
                        }

                    }
                });
            });
            observer.observe(headerElement);
        }
    }
    function initAgain() {
        if (!inInit)
            setTimeout(() => {
                inInit = true;
                fetchElements();
                alterSummaryInput();
            }, 3000);
    }
    function alterSummaryInput() {
        let chatbutton = document.querySelector('.embeddedServiceHelpButton');
        let config = { attributes: true, childList: true, characterData: false }
        let observer = new MutationObserver((mutations) => {

            let textElement = document.querySelector('#Chat_Description__c');

            console.log('textElement', textElement)
            if (textElement) {
                textElement.style.display = 'none';
                let textAreaElement = document.createElement('textarea');
                textAreaElement.addEventListener('keyup', _copyValueToChatDisc);
                textAreaElement.setAttribute('class', 'slds-style-inputtext input');
                textAreaElement.setAttribute('maxlength', '255');
                textAreaElement.setAttribute('style', 'min-height:70px');
                textElement.insertAdjacentElement('afterend', textAreaElement);
            }


        });
        if (chatbutton) observer.observe(chatbutton, config);



    }
    function _copyValueToChatDisc(e) {
        let textElement = document.querySelector('#Chat_Description__c');
        textElement.value = e.srcElement.value;

        textElement.dispatchEvent(changeEvent);
    }
</script>
<script type='text/javascript' src='https://service.force.com/embeddedservice/5.0/esw.min.js'></script>
<script type='text/javascript'>
    var initESW = function (gslbBaseURL) {
        embedded_svc.settings.displayHelpButton = true; //Or false
        embedded_svc.settings.language = 'de'; //For example, enter 'en' or 'en-US'

        embedded_svc.settings.defaultMinimizedText = 'Nehmen Sie Kontakt auf '; //(Defaults to Chat with an Expert)
        embedded_svc.settings.disabledMinimizedText = 'Nehmen Sie Kontakt auf '; //(Defaults to Agent Offline)

        embedded_svc.settings.loadingText = 'Nehmen Sie Kontakt auf'; //(Defaults to Loading)

        embedded_svc.settings.offlineSupportMinimizedText = 'Nehmen Sie Kontakt auf'; //(Defaults to Contact Us)

        let Origin = window.location.origin || window.location.href || 'unknown';
        embedded_svc.settings.extraPrechatFormDetails = [
            {
                "label": "Vorname",
                "transcriptFields": ["Last_Name__c"],
                "displayToAgent": true

            },
            {
                "label": "Nachname",
                "transcriptFields": ["First_Name__c"],
                "displayToAgent": true

            },
            {
                "label": "E-Mail",
                "transcriptFields": ["Email__c"],
                "displayToAgent": true

            },
            {
                "label": "Chat Origin",
                "transcriptFields": ["Chat_Origin__c"],
                "value": Origin,
                "displayToAgent": true

            }
        ];

        embedded_svc.settings.extraPrechatInfo = [{
            "entityFieldMaps": [{
                "doCreate": false,
                "doFind": false,
                "fieldName": "LastName",
                "isExactMatch": false,
                "label": "Nachname"
            }, {
                "doCreate": false,
                "doFind": false,
                "fieldName": "FirstName",
                "isExactMatch": false,
                "label": "Vorname"
            }, {
                "doCreate": false,
                "doFind": true,
                "fieldName": "Email",
                "isExactMatch": true,
                "label": "E-Mail"
            }],
            "entityName": "Contact"
        }];

        //embedded_svc.settings.storageDomain = 'yourdomain.com'; //(Sets the domain for your deployment so that visitors can navigate subdomains during a chat session)

        // Settings for Chat
        //embedded_svc.settings.directToButtonRouting = function(prechatFormData) {
        // Dynamically changes the button ID based on what the visitor enters in the pre-chat form.
        // Returns a valid button ID.
        //};
        //embedded_svc.settings.prepopulatedPrechatFields = {}; //Sets the auto-population of pre-chat form fields
        //embedded_svc.settings.fallbackRouting = []; //An array of button IDs, user IDs, or userId_buttonId


        embedded_svc.settings.enabledFeatures = ['LiveAgent'];
        embedded_svc.settings.entryFeature = 'LiveAgent';

        embedded_svc.init(
            'https://ev-smartmoney--dev01.my.salesforce.com',
            'https://dev01-evsmartmoney.cs173.force.com/support',
            gslbBaseURL,
            '00D7Y000000BEFz',
            'Web_Support',
            {
                baseLiveAgentContentURL: 'https://c.la3-c1cs-cdg.salesforceliveagent.com/content',
                deploymentId: '5725I000000gPtx',
                buttonId: '5735I000000gQ4O',
                baseLiveAgentURL: 'https://d.la3-c1cs-cdg.salesforceliveagent.com/chat',
                eswLiveAgentDevName: 'Web_Support',
                isOfflineSupportEnabled: true
            }
        );
    };

    if (!window.embedded_svc) {
        var s = document.createElement('script');
        s.setAttribute('src', 'https://ev-smartmoney--dev01.my.salesforce.com/embeddedservice/5.0/esw.min.js');
        s.onload = function () {
            initESW(null);
        };
        document.body.appendChild(s);
    } else {
        initESW('https://service.force.com');
    }
</script>